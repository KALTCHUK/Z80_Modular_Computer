0001   0000             BOOT		.EQU	0
0002   0000             BIOS		.EQU	0E600H				; BIOS entry point
0003   0000             LEAP		.EQU	3					; 3 bytes for each entry (JP aaaa)
0004   0000             
0005   0000             CONST:		.EQU	BIOS+(LEAP*2)		;  2 Console status.
0006   0000             CONIN:		.EQU	BIOS+(LEAP*3)		;  3 Console input.
0007   0000             CONOUT:		.EQU	BIOS+(LEAP*4)		;  4 Console OUTput.
0008   0000             LIST:		.EQU	BIOS+(LEAP*5)		;  3 Console input.
0009   0000             LISTST:		.EQU	BIOS+(LEAP*15)		;  2 Console status.
0010   0000             PRINTSEQ:	.EQU	BIOS+(LEAP*17)		;  4 Console OUTput.
0011   0000             ;================================================================================================
0012   0000             ; ASCII characters.
0013   0000             ;================================================================================================
0014   0000             LF			.EQU	0AH
0015   0000             FF			.EQU	0CH
0016   0000             CR			.EQU	0DH
0017   0000             DC1			.EQU	11H
0018   0000             DC2			.EQU	12H
0019   0000             DC3			.EQU	13H
0020   0000             DC4			.EQU	14H
0021   0000             ESC			.EQU	1BH
0022   0000             ;================================================================================================
0023   0100             			.ORG	0100H
0024   0100             
0025   0100 0E 11       			LD	C,DC1			; Init LCD card
0026   0102 CD 0F E6    			CALL LIST
0027   0105             			
0028   0105 CD 33 E6    			CALL PRINTSEQ
0029   0108 3C 45 4E 54 			.DB "<ENTER>=LF, <ESC>=exit",CR,LF,0
0029   010C 45 52 3E 3D 
0029   0110 4C 46 2C 20 
0029   0114 3C 45 53 43 
0029   0118 3E 3D 65 78 
0029   011C 69 74 0D 0A 
0029   0120 00 
0030   0121             			
0031   0121 0E 0C       REPEAT:		LD	C,FF
0032   0123 CD 0F E6    			CALL LIST
0033   0126 CD C9 01    			CALL WAIT
0034   0129 CD D6 01    			CALL LCDSEQ
0035   012C 4F 76 65 72 			.DB	"Overhead the alb",0
0035   0130 68 65 61 64 
0035   0134 20 74 68 65 
0035   0138 20 61 6C 62 
0035   013C 00 
0036   013D CD C9 01    			CALL WAIT
0037   0140 CD D6 01    			CALL LCDSEQ
0038   0143 0D 0A 48 61 			.DB	CR,LF,"Hangs motionless",0
0038   0147 6E 67 73 20 
0038   014B 6D 6F 74 69 
0038   014F 6F 6E 6C 65 
0038   0153 73 73 00 
0039   0156 CD C9 01    			CALL WAIT
0040   0159 CD D6 01    			CALL LCDSEQ
0041   015C 0D 0A 41 6E 			.DB	CR,LF,"And deep beneath",0
0041   0160 64 20 64 65 
0041   0164 65 70 20 62 
0041   0168 65 6E 65 61 
0041   016C 74 68 00 
0042   016F CD C9 01    			CALL WAIT
0043   0172 CD D6 01    			CALL LCDSEQ
0044   0175 0D 0A 49 6E 			.DB	CR,LF,"In labyrinths of",0
0044   0179 20 6C 61 62 
0044   017D 79 72 69 6E 
0044   0181 74 68 73 20 
0044   0185 6F 66 00 
0045   0188 CD C9 01    			CALL WAIT
0046   018B CD D6 01    			CALL LCDSEQ
0047   018E 0D 0A 54 68 			.DB	CR,LF,"The echo of a di",0
0047   0192 65 20 65 63 
0047   0196 68 6F 20 6F 
0047   019A 66 20 61 20 
0047   019E 64 69 00 
0048   01A1 CD C9 01    			CALL WAIT
0049   01A4 CD D6 01    			CALL LCDSEQ
0050   01A7 0D 0A 43 6F 			.DB	CR,LF,"Comes willowing ",0
0050   01AB 6D 65 73 20 
0050   01AF 77 69 6C 6C 
0050   01B3 6F 77 69 6E 
0050   01B7 67 20 00 
0051   01BA CD C9 01    			CALL WAIT
0052   01BD CD D6 01    			CALL LCDSEQ
0053   01C0 0D 0A 00    			.DB	CR,LF,0
0054   01C3 CD C9 01    			CALL WAIT
0055   01C6 C3 21 01    			JP	REPEAT
0056   01C9             			
0057   01C9             ;================================================================================================
0058   01C9             ; Wait for user hir <ENTER>
0059   01C9             ;================================================================================================
0060   01C9 CD 09 E6    WAIT:		CALL CONIN
0061   01CC FE 1B       			CP	ESC
0062   01CE CA 00 00    			JP	Z,BOOT
0063   01D1 FE 0D       			CP	CR
0064   01D3 20 F4       			JR	NZ,WAIT
0065   01D5 C9          			RET
0066   01D6             			
0067   01D6             ;================================================================================================
0068   01D6             ; Print (on console) a sequence of characters ending with zero
0069   01D6             ;================================================================================================
0070   01D6 E3          LCDSEQ:		EX 	(SP),HL 		; Push HL and put RET address into HL
0071   01D7 F5          			PUSH 	AF
0072   01D8 C5          			PUSH 	BC
0073   01D9 7E          NEXTCHAR:	LD 	A,(HL)
0074   01DA FE 00       			CP	0
0075   01DC 28 07       			JR	Z,ENDOFPRINT
0076   01DE 4F          			LD  	C,A
0077   01DF CD 0F E6    			CALL 	LIST		; Print to LCD
0078   01E2 23          			INC 	HL
0079   01E3 18 F4       			JR	NEXTCHAR
0080   01E5 23          ENDOFPRINT:	INC 	HL 			; Get past "null" terminator
0081   01E6 C1          			POP 	BC
0082   01E7 F1          			POP 	AF
0083   01E8 E3          			EX 	(SP),HL 		; Push new RET address on stack and restore HL
0084   01E9 C9          			RET
0085   01EA             
0086   01EA             ;================================================================================================
0087   01EA             
0088   01EA             			.END
tasm: Number of errors = 0
