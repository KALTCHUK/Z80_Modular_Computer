0001   0000             ;==================================================================================
0002   0000             ; What this routine does: Fill a page, starting at a specific address, with 0x1A.
0003   0000             ; 
0004   0000             ; This routine is used to complete text files sent to Z80MC that will be
0005   0000             ; saved with "SAVE XX..." command. For example, if a .BAS file is sent
0006   0000             ; without performing this operation, MBASIC will not load the .BAS file.
0007   0000             ;
0008   0000             ; So the complete operation should be like this:
0009   0000             ;
0010   0000             ;	1) on Monitor: H
0011   0000             ;	2) on terminal emulator: send CompPage.OBJ (which will be written at 0C000H).
0012   0000             ;	1) on Monitor: W0100
0013   0000             ;	2) on cmd: xmit.py (input file name, e.g. KKK.BAS)
0014   0000             ;	3) on Monitor, read the last page received (using the result from xmit.py)
0015   0000             ;	4) find the next address after the last "0x0D 0x0A" sequence.
0016   0000             ;	5) write this address to SADDR (ORG+1=0C001H).
0017   0000             ;	6) execute CompPage routine (JC000).
0018   0000             ;	7) on CCP: SAVE xx... (xx is supplied by xmit.py).
0019   0000             ; 
0020   0000             ;==================================================================================
0021   0000             WAITCMD		.EQU	0D131H			; Reentry point to Monitor
0022   0000             FILLBYTE	.EQU	01AH
0023   0000             
0024   0000             ;================================================================================================
0025   C000             			.ORG 0C000H
0026   C000 18 02       		JR	HOP
0027   C002 00 00       SADDR	.DB	0,0
0028   C004 2A 02 C0    HOP:	LD	HL,(SADDR)
0029   C007 36 1A       		LD	(HL),FILLBYTE
0030   C009 E5          		PUSH	HL
0031   C00A D1          		POP DE
0032   C00B 13          		INC	DE
0033   C00C 06 00       		LD	B,0
0034   C00E 7B          		LD	A,E
0035   C00F ED 44       		NEG
0036   C011 4F          		LD	C,A
0037   C012 ED B0       		LDIR
0038   C014 C3 31 D1    		JP	WAITCMD
0039   C017             
0040   C017             		.END
tasm: Number of errors = 0
